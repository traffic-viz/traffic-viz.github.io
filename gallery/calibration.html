

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Calibration flights &mdash; traffic 2.6.6 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/jupyter-sphinx.css" type="text/css" />
  <link rel="stylesheet" href="../_static/thebelab.css" type="text/css" />
  <link rel="stylesheet" href="../_static/main_stylesheet.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/thebelab-helper.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
        <script src="https://cdn.jsdelivr.net/npm/vega-lite@4"></script>
        <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager/dist/embed-amd.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Zero-gravity flights" href="zero_gravity.html" />
    <link rel="prev" title="Sun elevation along a flight" href="sun_elevation.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> traffic
          

          
            
            <img src="../_static/logo_traffic.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                2.6.6
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide.html">User guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../gallery.html">Example gallery</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="is_this_a_plane.html">Is this a plane?</a></li>
<li class="toctree-l2"><a class="reference internal" href="heatmaps.html">Flight density heatmaps</a></li>
<li class="toctree-l2"><a class="reference internal" href="landing_sequence.html">Landing sequence</a></li>
<li class="toctree-l2"><a class="reference internal" href="landing_configuration.html">Landing configurations</a></li>
<li class="toctree-l2"><a class="reference internal" href="windfield.html">A Mode¬†S based wind field</a></li>
<li class="toctree-l2"><a class="reference internal" href="sun_elevation.html">Sun elevation along a flight</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Calibration flights</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#a-short-introduction-to-radio-navigation">A short introduction to radio-navigation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#a-basic-analysis-of-vor-calibration-trajectories">A basic analysis of VOR calibration trajectories</a></li>
<li class="toctree-l3"><a class="reference internal" href="#equipped-aircraft-for-beacon-calibration">Equipped aircraft for beacon calibration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="zero_gravity.html">Zero-gravity flights</a></li>
<li class="toctree-l2"><a class="reference internal" href="geomagnetic_declination.html">Geomagnetic declination</a></li>
<li class="toctree-l2"><a class="reference internal" href="tour_de_france.html">Tour de France 2020</a></li>
<li class="toctree-l2"><a class="reference internal" href="covid19.html">Impact of COVID-19 on worldwide aviation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gallery.html#third-party-examples">Third-party examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api_reference.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../publications.html">Publications</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">traffic</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../gallery.html">Example gallery</a> &raquo;</li>
        
      <li>Calibration flights</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/gallery/calibration.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <!-- The inclusion above triggers the inclusion of leaflet without conflicting other pages. -->

<script src="../_static/calibration.geojson"></script><div class="section" id="calibration-flights">
<h1>Calibration flights<a class="headerlink" href="#calibration-flights" title="Permalink to this headline">¬∂</a></h1>
<p><em>What is this plane doing?</em></p>
<p>This was my first reaction after hitting on the following trajectory during an
analysis of approaches at Toulouse airport. After exchanges with ATC people, I
learned that these trajectories are flown by small aircraft working at
calibrating landing assistance systems, including ILS and VOR.</p>
<p>These trajectories mostly consist of many low passes over an airport and large
circles or arcs of circle. A small sample of such trajectories is included in
traffic.data.samples, and the following snippet of code will let you explore
those before an attempt of explanation.</p>
Select a different area/airport: <select
    id="city_selector"
    style="-webkit-appearance: none; -moz-appearance: none; -o-appearance: none; appearance: none; padding-top: 0.25em; padding-bottom: 0.25em; background-image: url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE5LjIuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHZpZXdCb3g9IjAgMCAxOCAxOCIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMTggMTg7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4KPHN0eWxlIHR5cGU9InRleHQvY3NzIj4KCS5zdDB7ZmlsbDpub25lO30KPC9zdHlsZT4KPHBhdGggZD0iTTUuMiw1LjlMOSw5LjdsMy44LTMuOGwxLjIsMS4ybC00LjksNWwtNC45LTVMNS4yLDUuOXoiLz4KPHBhdGggY2xhc3M9InN0MCIgZD0iTTAtMC42aDE4djE4SDBWLTAuNnoiLz4KPC9zdmc+Cg'); background-position-x: 100%; background-position-y: 50%; background-repeat: no-repeat; background-size: 20px auto; box-shadow: none; box-sizing: border-box; border-radius: 0px 0px 0px 0px; height: 28px; width: 15em; line-height: 16px; font-size: 13px;"
    onchange="city_select()"
    >
    <option value="Ajaccio, France">Ajaccio,&nbsp;France</option>
    <option value="Bornholm, Denmark">Bornholm,&nbsp;Denmark</option>
    <option value="Brussels, Belgium">Brussels,&nbsp;Belgium</option>
    <option value="Cardiff, United Kingdom">Cardiff,&nbsp;United&nbsp;Kingdom</option>
    <option value="Funchal, Madeira">Funchal,&nbsp;Madeira</option>
    <option value="Guatemala City">Guatemala&nbsp;City</option>
    <option value="Kingston, Jamaica">Kingston,&nbsp;Jamaica</option>
    <option value="Kiruna, Sweden">Kiruna,&nbsp;Sweden</option>
    <option value="Kota Kinabalu, Malaysia">Kota&nbsp;Kinabalu,&nbsp;Malaysia</option>
    <option value="Lisbon, Portugal">Lisbon,&nbsp;Portugal</option>
    <option value="London, United Kingdom">London,&nbsp;United Kingdom</option>
    <option value="Monastir, Tunisia">Monastir,&nbsp;Tunisia</option>
    <option value="Montr√©al, Canada">Montr√©al,&nbsp;Canada</option>
    <option value="Munich, Germany">Munich,&nbsp;Germany</option>
    <option value="Noum√©a, New Caledonia">Noum√©a,&nbsp;New&nbsp;Caledonia</option>
    <option value="Perth, Australia">Perth,&nbsp;Australia</option>
    <option value="Toulouse, France" selected='selected'>Toulouse,&nbsp;France</option>
    <option value="Vancouver, Canada">Vancouver,&nbsp;Canada</option>
    <option value="Vienna, Austria">Vienna,&nbsp;Austria</option>
</select>

<div id="mymap" style="width: 100%; height: 500px; margin-bottom: 1em; margin-top: 1em"></div>

<script>
    var mymap;
    var mymap_ready = false;

    function city_select() {
        var inp = document.getElementById('city_selector');
        var osm_url = 'https://nominatim.openstreetmap.org/search?format=json&limit=1&q='
        $.getJSON(
            osm_url + inp.value, function(data) {
                $.each(
                    data, function(key, val) {
                        mymap.setView([val.lat, val.lon], 9);
                    }
                )
            }
        )
    };

    setInterval(function() {

    if ((typeof (L) !== "undefined") & ~mymap_ready) {

    mymap = L.map( 'mymap', {
        center: [43.59601301626894, 1.4321018748075245],
        scrollWheelZoom: false,
        zoom: 9
    })

    L.tileLayer('http://stamen-tiles-a.a.ssl.fastly.net/terrain/{z}/{x}/{y}.png', {
        maxZoom: 18,
        attribution:
        'Map tiles by <a href="http://stamen.com/">Stamen Design</a>, '+
        'under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. '+
        'Data by <a href="http://openstreetmap.org/">OpenStreetMap</a>, '+
        'under <a href="http://creativecommons.org/licenses/by-sa/3.0">CC BY SA</a>.',
        id: 'stamen.terrain'
    }).addTo(mymap);


    L.geoJson(
        calibration_trajectories,
        style={
            color: '#0033FF'
        }
    ).bindPopup(function (layer) {
        return "<b>Trajectory "
          + layer.feature.properties.flight_id
          + "</b><br/> with aircraft "
          + layer.feature.properties.registration
          + " and callsign "
          + layer.feature.properties.callsign;
    }).addTo(mymap);

    mymap_ready = true

  }}, 1000)
</script><p>You may click on trajectories for more information.</p>
<div class="section" id="a-short-introduction-to-radio-navigation">
<h2>A short introduction to radio-navigation<a class="headerlink" href="#a-short-introduction-to-radio-navigation" title="Permalink to this headline">¬∂</a></h2>
<p>A number of navigational systems emerged in the second half of the 20th century,
mainly based on VHF communications. Some of them were designed for surveillance,
like <a class="reference external" href="https://en.wikipedia.org/wiki/Secondary_surveillance_radar">Secondary surveillance radars</a>; other systems
also came to assist pilot in navigation and landing.</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/VHF_omnidirectional_range">VOR</a> (VHF
Omnidirectional Range) ground stations send an omnidirectional master signal
(on a predefined frequency determined for each station) and a second highly
directional signal. Aircraft measure the phase difference between the two
signals, which corresponds to the bearing from the station to the aircraft.¬†<a class="footnote-reference brackets" href="#id3" id="id1">1</a></p>
<p>Historically, airways were laid out between VORs, which stand at the
intersections between those routes. Advances in GNSS (understand GPS) make these
stations less necessary.</p>
<p>VOR stations often host a <a class="reference external" href="https://en.wikipedia.org/wiki/Distance_measuring_equipment">DME</a> (Distance
Measuring Equipment). The principle is similar to radar ranging, except the
roles of the aircraft and of the ground station are reversed. The aircraft sends
a signal to the DME; the DME repeats the same signal 50 Œºs after reception. When
the aircraft receives a copy of the sent messages, it measures the time of
travel to the DME, subtracts 50 Œºs and divides the results by 2: speed of light
gives an estimation of the distance between the aircraft to the ground station.</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Instrument_landing_system">ILS</a> (Instrument
Landing Systems) consists of two guidance systems: a lateral one (the LOC, for
<em>localizer</em>) and a vertical one (the GS, for <em>glide slope</em>, also <em>glide path</em>).
The localizer usually consists of several pairs of directional antennas placed
beyond the departure end of the runway.¬†<a class="footnote-reference brackets" href="#id4" id="id2">2</a></p>
<p>Local authorities define very strict thresholds for accuracy: internal
monitoring shall switch off the system if the accuracy of the signal is not
appropriate. All radio-navigation beacons (including VOR, DME and ILS) are
checked periodically by specially equipped aircraft. In particular, the VOR test
consists of flying around the beacon in circles at defined distances and along
several radials.</p>
<dl class="footnote brackets">
<dt class="label" id="id3"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>Decoding VOR signals can be a fun exercice for the amateur software radio developper. (<a class="reference external" href="https://www.radiojitter.com/real-time-decoding-of-vor-using-rtl-sdr/">link</a>)</p>
</dd>
<dt class="label" id="id4"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>Check for them next time you drive around an airport!</p>
</dd>
</dl>
</div>
<div class="section" id="a-basic-analysis-of-vor-calibration-trajectories">
<h2>A basic analysis of VOR calibration trajectories<a class="headerlink" href="#a-basic-analysis-of-vor-calibration-trajectories" title="Permalink to this headline">¬∂</a></h2>
<p>We can have a look at the first trajectory in the calibration dataset. The
aircraft takes off from Ajaccio airport before flying concentric circles and
radials. There must be a VOR around, we can search in the navaid database:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># see https://traffic-viz.github.io/samples.html if any issue on import</span>
<span class="kn">from</span> <span class="nn">traffic.data.samples.calibration</span> <span class="kn">import</span> <span class="n">ajaccio</span>
<span class="kn">from</span> <span class="nn">traffic.data</span> <span class="kn">import</span> <span class="n">navaids</span>

<span class="n">navaids</span><span class="o">.</span><span class="n">extent</span><span class="p">(</span><span class="n">ajaccio</span><span class="p">)</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;type == &quot;VOR&quot;&#39;</span><span class="p">)</span>
</pre></div>
</div>
<table class="dataframe" border="0">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>type</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>altitude</th>
      <th>frequency</th>
      <th>description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>126858</th>
      <td>AJO</td>
      <td>VOR</td>
      <td>41.770528</td>
      <td>8.774667</td>
      <td>2142.0</td>
      <td>114.8</td>
      <td>AJACCIO VOR-DME</td>
    </tr>
    <tr>
      <th>127828</th>
      <td>FGI</td>
      <td>VOR</td>
      <td>41.502194</td>
      <td>9.083417</td>
      <td>87.0</td>
      <td>116.7</td>
      <td>FIGARI VOR-DME</td>
    </tr>
  </tbody>
</table><p>Next step is to compute for each point the distance and bearing from the VOR to
each point of the trajectory. The parts of the trajectory that are of interest
are the ones with little to no variation in the distance (circles) and in the
bearing (radials) to the VOR.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">vor</span> <span class="o">=</span> <span class="n">navaids</span><span class="o">.</span><span class="n">extent</span><span class="p">(</span><span class="n">ajaccio</span><span class="p">)[</span><span class="s1">&#39;AJO&#39;</span><span class="p">]</span>

<span class="n">ajaccio</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">ajaccio</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">vor</span><span class="p">)</span>  <span class="c1"># add a distance column (in nm) w.r.t the VOR</span>
    <span class="o">.</span><span class="n">bearing</span><span class="p">(</span><span class="n">vor</span><span class="p">)</span>  <span class="c1"># add a bearing column w.r.t the VOR</span>
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span>
        <span class="n">distance_diff</span><span class="o">=</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">abs</span><span class="p">(),</span>  <span class="c1"># large circles</span>
        <span class="n">bearing_diff</span><span class="o">=</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">bearing</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">abs</span><span class="p">(),</span>  <span class="c1"># long radials</span>
    <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<p>We can write a simple .query() followed by a .split() method to select all
segments with a constant bearing with respect to the selected VOR.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">segment</span> <span class="ow">in</span> <span class="n">ajaccio</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;bearing_diff &lt; .01&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;1T&#39;</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">segment</span><span class="o">.</span><span class="n">longer_than</span><span class="p">(</span><span class="s1">&#39;5 minutes&#39;</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">segment</span><span class="o">.</span><span class="n">duration</span><span class="p">)</span>

<span class="c1"># 0 days 00:05:05</span>
<span class="c1"># 0 days 00:05:10</span>
<span class="c1"># 0 days 00:17:20</span>
<span class="c1"># 0 days 00:22:35</span>
<span class="c1"># 0 days 00:05:20</span>
<span class="c1"># 0 days 00:09:40</span>
<span class="c1"># 0 days 00:08:15</span>
</pre></div>
</div>
<p>We have all we need to enhance the interesting parts of the trajectory now:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">from</span> <span class="nn">cartes.crs</span> <span class="kn">import</span> <span class="n">Lambert93</span>
<span class="kn">from</span> <span class="nn">traffic.drawing</span> <span class="kn">import</span> <span class="n">countries</span>
<span class="kn">from</span> <span class="nn">traffic.data</span> <span class="kn">import</span> <span class="n">airports</span>

<span class="n">point_params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">text_kw</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">fontname</span><span class="o">=</span><span class="s2">&quot;Ubuntu&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">))</span>
<span class="n">box_params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round&quot;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;lightpink&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.7</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="s2">&quot;traffic&quot;</span><span class="p">):</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">subplot_kw</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">Lambert93</span><span class="p">()))</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">countries</span><span class="p">(</span><span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;midnightblue&quot;</span><span class="p">))</span>

    <span class="n">airports</span><span class="p">[</span><span class="s2">&quot;LFKJ&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;^&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">point_params</span><span class="p">)</span>
    <span class="n">shift_vor</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="s2">&quot;dots&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">vor</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;h&quot;</span><span class="p">,</span> <span class="n">shift</span><span class="o">=</span><span class="n">shift_vor</span><span class="p">,</span> <span class="o">**</span><span class="n">point_params</span><span class="p">)</span>

    <span class="c1"># background with the full trajectory</span>
    <span class="n">ajaccio</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#aaaaaa&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>

    <span class="c1"># plot large circles in red</span>
    <span class="k">for</span> <span class="n">segment</span> <span class="ow">in</span> <span class="n">ajaccio</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;distance_diff &lt; .02&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;1 minute&quot;</span><span class="p">):</span>
        <span class="c1"># only print the segment if it is long enough</span>
        <span class="k">if</span> <span class="n">segment</span><span class="o">.</span><span class="n">longer_than</span><span class="p">(</span><span class="s2">&quot;3 minutes&quot;</span><span class="p">):</span>
            <span class="n">segment</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;crimson&quot;</span><span class="p">)</span>
            <span class="n">distance_vor</span> <span class="o">=</span> <span class="n">segment</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

            <span class="c1"># an annotation with the radius of the circle</span>
            <span class="n">segment</span><span class="o">.</span><span class="n">at</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="n">ax</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>  <span class="c1"># We don&#39;t need the point, only the text</span>
                <span class="n">text_kw</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">distance_vor</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> nm&quot;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">box_params</span><span class="p">)</span>
            <span class="p">)</span>

    <span class="k">for</span> <span class="n">segment</span> <span class="ow">in</span> <span class="n">ajaccio</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;bearing_diff &lt; .01&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;1 minute&quot;</span><span class="p">):</span>
        <span class="c1"># only print the segment if it is long enough</span>
        <span class="k">if</span> <span class="n">segment</span><span class="o">.</span><span class="n">longer_than</span><span class="p">(</span><span class="s2">&quot;3 minutes&quot;</span><span class="p">):</span>
            <span class="n">segment</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;forestgreen&quot;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">((</span><span class="mf">7.6</span><span class="p">,</span> <span class="mf">9.9</span><span class="p">,</span> <span class="mf">41.3</span><span class="p">,</span> <span class="mf">43.3</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;geo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">background_patch</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/ajaccio_map.png"><img alt="Situational map" class="align-center" src="../_images/ajaccio_map.png" style="width: 341.59999999999997px; height: 390.59999999999997px;" /></a>
<p>The following map displays the result of a similar processing on the other VOR
calibration trajectories from the sample dataset. <a class="footnote-reference brackets" href="#id6" id="id5">3</a></p>
Select a different VOR: <select
    id="vor_selector"
    style="-webkit-appearance: none; -moz-appearance: none; -o-appearance: none; appearance: none; padding-top: 0.25em; padding-bottom: 0.25em; background-image: url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE5LjIuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHZpZXdCb3g9IjAgMCAxOCAxOCIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMTggMTg7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4KPHN0eWxlIHR5cGU9InRleHQvY3NzIj4KCS5zdDB7ZmlsbDpub25lO30KPC9zdHlsZT4KPHBhdGggZD0iTTUuMiw1LjlMOSw5LjdsMy44LTMuOGwxLjIsMS4ybC00LjksNWwtNC45LTVMNS4yLDUuOXoiLz4KPHBhdGggY2xhc3M9InN0MCIgZD0iTTAtMC42aDE4djE4SDBWLTAuNnoiLz4KPC9zdmc+Cg'); background-position-x: 100%; background-position-y: 50%; background-repeat: no-repeat; background-size: 20px auto; box-shadow: none; box-sizing: border-box; border-radius: 0px 0px 0px 0px; height: 28px; width: 15em; line-height: 16px; font-size: 13px;"
    onchange="vor_select()"
    >
    <option value="41.770528 8.774667 8 ajo">Ajaccio VOR-DME</option>
    <option value="50.902222 4.538056 9 bub">Brussels VOR-DME</option>
    <option value="32.747039 -16.705686 9 fun">Madeira VOR-DME</option>
    <option value="-22.315389 166.473167 9 mga">Ouere VOR-DME</option>
    <option value="-31.673889 116.017222 9 pea">Pearce TACAN</option>
    <option value="15.00863889 -90.47033333 9 rab">Rabinal VOR-DME</option>
</select>

<div id="vormap" style="width: 100%; height: 500px; margin-bottom: 1em; margin-top: 1em"></div>

<script>

    var vormap;
    var vormap_ready = false;
    var ajo, bub, fun, mga, pea, rab;

    function vor_select() {
        var inp = document.getElementById('vor_selector');
        var tab = inp.value.split(' ');
        vormap.setView([tab[0], tab[1]], tab[2]);
        eval(tab[3]).openPopup();
    };

    /* delay the creation of the map after the whole page has been loaded */
    setInterval(function() {

    if ((typeof (L) !== "undefined") & ~vormap_ready) {
    vormap = L.map( 'vormap', {
        center: [41.770528, 8.774667],
        scrollWheelZoom: false,
        zoom: 8
    })

    L.tileLayer('http://stamen-tiles-a.a.ssl.fastly.net/terrain/{z}/{x}/{y}.png', {
        maxZoom: 18,
        attribution:
        'Map tiles by <a href="http://stamen.com/">Stamen Design</a>, '+
        'under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. '+
        'Data by <a href="http://openstreetmap.org/">OpenStreetMap</a>, '+
        'under <a href="http://creativecommons.org/licenses/by-sa/3.0">CC BY SA</a>.',
        id: 'stamen.terrain'
    }).addTo(vormap);


    L.geoJson(
        calibration_trajectories,
        style={
            color: '#FED976',
            weight: 2
        }
    ).bindPopup(function (layer) {
        return "<b>Trajectory "
          + layer.feature.properties.flight_id
          + "</b><br/> with aircraft "
          + layer.feature.properties.registration
          + " and callsign "
          + layer.feature.properties.callsign;
    }).addTo(vormap);

    L.geoJson(
        calibration_segments,
        {
           style: function (feature) {
               return {
                   color: feature.properties.color,
                   weight: 2
              };
           }
        }
    ).addTo(vormap);

    ajo = L.marker([41.770528, 8.774667]);
    ajo.addTo(vormap);
    ajo.bindPopup('<b>Ajaccio VOR-DME</b>')
    bub = L.marker([50.902222, 4.538056]);
    bub.addTo(vormap);
    bub.bindPopup('<b>Brussels VOR-DME</b>')
    fun = L.marker([32.747039, -16.705686]);
    fun.addTo(vormap);
    fun.bindPopup('<b>Madeira VOR-DME</b>')
    mga = L.marker([-22.315389, 166.473167]);
    mga.addTo(vormap);
    mga.bindPopup('<b>Ouere VOR-DME</b>')
    pea = L.marker([-31.673889, 116.017222]);
    pea.addTo(vormap);
    pea.bindPopup('<b>Pearce TACAN</b>')
    rab = L.marker([15.00863889, -90.47033333]);
    rab.addTo(vormap);
    rab.bindPopup('<b>Rabinal VOR-DME</b>')

    ajo.openPopup();
    vormap_ready = true;

  }})

</script><dl class="footnote brackets">
<dt class="label" id="id6"><span class="brackets"><a class="fn-backref" href="#id5">3</a></span></dt>
<dd><p>Time, distance and bearing thresholds may need further ajustments for a proper picture. Note the kiruna14 seems to circle around a position that is not referenced in the database. Any help or insight welcome!</p>
</dd>
</dl>
</div>
<div class="section" id="equipped-aircraft-for-beacon-calibration">
<h2>Equipped aircraft for beacon calibration<a class="headerlink" href="#equipped-aircraft-for-beacon-calibration" title="Permalink to this headline">¬∂</a></h2>
<p>This list only contains the equipped aircraft for the calibration in the sample
dataset. Apart from F-HNAV, registration numbers were found on social networks.
Two of the aircraft registrations were not in the provided database at the time
of the writing, so we added them manually.</p>
<blockquote class="twitter-tweet" style="width: 100%"><p lang="en" dir="ltr">Ever seen a Runway Calibration ? <a href="https://twitter.com/Beechcraft?ref_src=twsrc%5Etfw">@Beechcraft</a> <a href="https://twitter.com/hashtag/B300?src=hash&amp;ref_src=twsrc%5Etfw">#B300</a> VH-FIZ was out calibrating RWY16L <a href="https://twitter.com/SydneyAirport?ref_src=twsrc%5Etfw">@SydneyAirport</a> this morning, making a number of approaches to calibrate and certify ILS precision üíØ. The orbits in the track are done to fit in with regular arrivals and departures ‚úàÔ∏èüíôüì∑ <a href="https://t.co/CRkXfsscHa">pic.twitter.com/CRkXfsscHa</a></p>&mdash; 16Right Media (@www16Right) <a href="https://twitter.com/www16Right/status/982854657151197185?ref_src=twsrc%5Etfw">April 8, 2018</a></blockquote>
<!--<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>--><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">traffic.data.samples.calibration</span> <span class="kn">import</span> <span class="n">traffic</span> <span class="k">as</span> <span class="n">calibration</span>
<span class="kn">from</span> <span class="nn">traffic.data</span> <span class="kn">import</span> <span class="n">aircraft</span>

<span class="c1"># aircraft not in junzis database</span>
<span class="n">other_aircraft</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;4076f1&quot;</span><span class="p">:</span> <span class="s2">&quot;G-TACN (DA62)&quot;</span><span class="p">,</span> <span class="s2">&quot;750093&quot;</span><span class="p">:</span> <span class="s2">&quot;9M-FCL (LJ60)&quot;</span><span class="p">}</span>

<span class="p">(</span>
    <span class="n">calibration</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;flight_id&quot;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="s2">&quot;icao24&quot;</span><span class="p">:</span> <span class="s2">&quot;first&quot;</span><span class="p">})</span>
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span>
        <span class="n">registration</span><span class="o">=</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">icao24</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">aircraft</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">regid</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">aircraft</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">mdl</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="si">}</span><span class="s2">)&quot;</span>
            <span class="k">if</span> <span class="n">aircraft</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span>
            <span class="k">else</span> <span class="n">other_aircraft</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="p">),</span>
        <span class="n">flight_id</span><span class="o">=</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
            <span class="c1"># not the most efficient way but quite readable</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">flight_id</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">timestamp</span><span class="si">:</span><span class="s2">%Y-%M-%d</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s2">&quot;registration&quot;</span><span class="p">,</span> <span class="s2">&quot;timestamp&quot;</span><span class="p">])</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;registration&quot;</span><span class="p">,</span> <span class="s2">&quot;icao24&quot;</span><span class="p">])</span>
    <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">flight_id</span><span class="p">))</span>
    <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="k">lambda</span> <span class="n">series</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;flights&quot;</span><span class="p">:</span> <span class="n">series</span><span class="p">}))</span>
<span class="p">)</span>
</pre></div>
</div>
<table class="dataframe" border="0">
  <thead>
    <tr style="text-align: left;">
      <th></th>
      <th></th>
      <th>flights</th>
    </tr>
    <tr>
      <th>registration</th>
      <th>icao24</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>9M-FCL (LJ60)</th>
      <th>750093</th>
      <td>kota_kinabalu (2017-03-08)</td>
    </tr>
    <tr>
      <th>C-GFIO (CRJ2)</th>
      <th>c052bb</th>
      <td>vancouver (2018-10-06)</td>
    </tr>
    <tr>
      <th>C-GNVC (CRJ2)</th>
      <th>c06921</th>
      <td>montreal (2018-12-11)</td>
    </tr>
    <tr>
      <th>D-CFMD (B350)</th>
      <th>3cce6f</th>
      <td>munich (2019-03-04), vienna (2018-11-20)</td>
    </tr>
    <tr>
      <th>F-HNAV (BE20)</th>
      <th>39b415</th>
      <td>ajaccio (2018-01-12), monastir (2018-11-21), toulouse (2017-06-16), ...</td>
    </tr>
    <tr>
      <th>G-GBAS (DA62)</th>
      <th>4070f4</th>
      <td>london_heathrow (2018-01-12), lisbon (2018-11-13), funchal (2018-11-23)</td>
    </tr>
    <tr>
      <th>G-TACN (DA62)</th>
      <th>4076f1</th>
      <td>cardiff (2019-02-15), london_gatwick (2019-02-28)</td>
    </tr>
    <tr>
      <th>SE-LKY (BE20)</th>
      <th>4ab179</th>
      <td>bornholm (2018-11-26), kiruna (2019-01-30)</td>
    </tr>
    <tr>
      <th>VH-FIZ (B350)</th>
      <th>7c1a89</th>
      <td>noumea (2017-11-05), perth (2019-01-22)</td>
    </tr>
    <tr>
      <th>YS-111-N (BE20)</th>
      <th>0b206f</th>
      <td>guatemala (2018-03-26), kingston (2018-06-26)</td>
    </tr>
  </tbody>
</table><div>
<a class="reference internal image-reference" href="https://cdn.jetphotos.com/full/6/55737_1538774410.jpg" target='_blank'><img alt="F-HNAV" class="align-center" src="https://cdn.jetphotos.com/full/6/55533_1526410235.jpg" title="¬© Kris Van Craenenbroeck | Jetphotos" style="max-height: 200px; float: left; padding: 20px"></a>
<a class="reference internal image-reference" href="https://www.jetphotos.com/photo/9094827" target='_blank'><img alt="C-GFIO" class="align-center" src="https://cdn.jetphotos.com/full/6/55737_1538774410.jpg" title="¬© Keeper1 | Jetphotos" style="max-height: 200px; display: block; padding: 20px"></a>
</div></div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="zero_gravity.html" class="btn btn-neutral float-right" title="Zero-gravity flights" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="sun_elevation.html" class="btn btn-neutral float-left" title="Sun elevation along a flight" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2018, Xavier Olive.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  
 

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-412789-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-412789-3');
</script>



</body>
</html>